:ruby
  avatar = Movielog.avatars[person.slug]
  credits = []
  credits << 'directed by' if person.direction_credits
  credits << 'with' if person.performance_credits
  credits << 'written by' if person.writing_credits
  lists = [
    {
      text: 'Director',
      credits: person.direction_credits
    },
    {
      text: 'Performer',
      credits: person.performance_credits
    },
    {
      text: 'Writer',
      credits: person.writing_credits
    }
  ]

%header.cast_and_crew-header
  - if avatar
    .cast_and_crew-avatar{ data: { backdrop: avatar.image_url }}
  %h1.cast_and_crew-heading
    <span>Reviews of movies #{credits.to_sentence}</span> #{person.first_name} #{person.last_name}

.cast_and_crew-credits
  - lists.each do |list|
    - if list[:credits]
      %h2.cast_and_crew-credits_heading{ id: list[:text].downcase }
        As #{list[:text]} (#{list[:credits].length} titles)
      - posts = list[:credits].map{ |t| Movielog.reviews_by_title[t] }
      %ol.cast_and_crew-credits_list
        - posts.each_with_index do |post, index|
          %li.cast_and_crew-credits_list_item
            %div.cast_and_crew-credit
              .cast_and_crew-credit_content
                %header.cast_and_crew-credit_header
                  %h3.cast_and_crew-credit_title
                    %a.cast_and_crew-credit_header_link{ href: href_for_post(post) }
                      = post.display_title
                %a.cast_and_crew-credit_backdrop_wrap{ href: href_for_post(post) }
                  .cast_and_crew-credit_backdrop{ data: { backdrop: post.backdrop } }
                .cast_and_crew-credit_excerpt
                  = first_paragraph(grade_to_image_tag(grade: post.grade, options: { class: 'cast_and_crew-credit_grade' }) + ' ' + post.content)

